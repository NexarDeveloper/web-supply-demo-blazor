@layout RootLayout
@inherits LayoutComponentBase
@implements IDisposable
@inject Services.AppData AppData

<Layout Sider="true">
    <LayoutSider>
        <LayoutSiderContent>
            <Bar @ref="@sidebar" Breakpoint="Breakpoint.Desktop" NavigationBreakpoint="Breakpoint.Tablet" ThemeContrast="ThemeContrast.Dark"
                 Mode="BarMode.VerticalInline" CollapseMode="BarCollapseMode.Hide">
                <BarBrand>
                    <BarItem>
                        <BarLink To="">
                            <BarIcon IconName="customIcon" />
                            Nexar.Supply <Badge Color="Color.Primary">Demo</Badge>
                        </BarLink>
                    </BarItem>
                </BarBrand>
                <BarMenu>
                    <BarStart>
                        @if (AppData.Token == null)
                        {
                            <BarItem>
                                <BarLink To="">
                                    <BarIcon IconName="Blazorise.Icons.FontAwesome.FontAwesomeIcons.SignInAlt" />
                                    Login
                                </BarLink>
                            </BarItem>
                        }
                        else
                        {
                            <BarItem>
                                <BarLink To="search">
                                    <BarIcon IconName="Blazorise.Icons.FontAwesome.FontAwesomeIcons.Search" />
                                    Search
                                </BarLink>
                            </BarItem>
                            <BarItem>
                                <BarLink To="attributes">
                                    <BarIcon IconName="Blazorise.Icons.FontAwesome.FontAwesomeIcons.At" />
                                    Attributes
                                </BarLink>
                            </BarItem>
                            <BarItem>
                                <BarLink To="categories">
                                    <BarIcon IconName="Blazorise.Icons.FontAwesome.FontAwesomeIcons.Stream" />
                                    Categories
                                </BarLink>
                            </BarItem>
                            <BarItem>
                                <BarLink To="manufacturers">
                                    <BarIcon IconName="Blazorise.Icons.FontAwesome.FontAwesomeIcons.Industry" />
                                    Manufacturers
                                </BarLink>
                            </BarItem>
                            <BarItem>
                                <BarLink To="sellers">
                                    <BarIcon IconName="Blazorise.Icons.FontAwesome.FontAwesomeIcons.ShoppingCart" />
                                    Sellers
                                </BarLink>
                            </BarItem>
                        }
                    </BarStart>
                </BarMenu>
            </Bar>
        </LayoutSiderContent>
    </LayoutSider>
    <Layout>
        <LayoutHeader Fixed="true">
            <Bar @bind-Visible="@topbarVisible" Breakpoint="Breakpoint.Desktop" Background="Background.Primary" ThemeContrast="ThemeContrast.Light">
                <BarToggler Bar="@sidebar" />
                <BarBrand>
                    <BarItem>
                        <BarLink To="">
                            Nexar.Supply <Badge Color="Color.Primary">Demo</Badge>
                        </BarLink>
                    </BarItem>
                </BarBrand>
                <BarToggler />
                <BarMenu>
                    <BarStart>
                        <BarItem>
                            <BarLink To="https://octopart.com/api/v4/values" Title="Octopart search page" Target="Target.Blank">Octopart search</BarLink>
                        </BarItem>
                    </BarStart>
                    <BarEnd>
                        <BarItem>
                            <BarLink To="https://github.com/NexarDeveloper/web-supply-demo-blazor" Title="GitHub repository" Target="Target.Blank">GitHub</BarLink>
                        </BarItem>
                        <BarItem>
                            <BarLink To="@AppData.NexarDotCom" Title="Nexar home page" Target="Target.Blank">nexar.com</BarLink>
                        </BarItem>
                    </BarEnd>
                </BarMenu>
            </Bar>
        </LayoutHeader>
        <LayoutContent Padding="Padding.Is3.OnX">
            @Body
        </LayoutContent>
    </Layout>
</Layout>

@code{
    Bar sidebar;
    bool topbarVisible = false;

    protected override void OnInitialized()
    {
        AppData.OnChange += StateHasChanged;
    }

    public void Dispose()
    {
        AppData.OnChange -= StateHasChanged;
    }

    RenderFragment customIcon =@<img src="/brand.png" style="width:32px; height: 32px" />;
}
